<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MeetOnSamePage - Find Common Flights</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Hide icons until Lucide loads to prevent underlines -->
    <style>
        i[data-lucide] { 
            display: inline-block;
            width: 1em;
            height: 1em;
            font-style: normal;
            visibility: hidden;
        }
        i[data-lucide] svg {
            visibility: visible;
        }
    </style>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <div class="container">
        <!-- Tab Bar -->
        <nav class="tab-bar">
            <div class="tab-buttons">
                <div class="tab-indicator"></div>
                <button class="tab-btn active" data-tab="search" onclick="switchTab('search')">
                    <i data-lucide="search" class="tab-icon"></i>
                    Search
                </button>
                <button class="tab-btn" data-tab="info" onclick="switchTab('info')">
                    <i data-lucide="info" class="tab-icon"></i>
                    Info
                </button>
            </div>
            
            <!-- Right Side Actions -->
            <div class="tab-actions">
                <!-- Language Mini Dropdown -->
                <div class="lang-mini" id="langDropdown">
                    <button type="button" class="lang-trigger" onclick="toggleLangDropdown(event)">
                        <span class="lang-flag">üá¨üáß</span>
                        <span class="lang-selected">EN</span>
                        <i data-lucide="chevron-down" class="lang-arrow"></i>
                    </button>
                    <div class="lang-menu">
                        <div class="lang-item active" data-value="en" data-flag="üá¨üáß" data-code="EN" onclick="selectLang(this)">
                            <span class="lang-item-flag">üá¨üáß</span>
                            <span class="lang-item-code">English</span>
                        </div>
                        <div class="lang-item" data-value="tr" data-flag="üáπüá∑" data-code="TR" onclick="selectLang(this)">
                            <span class="lang-item-flag">üáπüá∑</span>
                            <span class="lang-item-code">T√ºrk√ße</span>
                        </div>
                        <div class="lang-item" data-value="de" data-flag="üá©üá™" data-code="DE" onclick="selectLang(this)">
                            <span class="lang-item-flag">üá©üá™</span>
                            <span class="lang-item-code">Deutsch</span>
                        </div>
                        <div class="lang-item" data-value="fr" data-flag="üá´üá∑" data-code="FR" onclick="selectLang(this)">
                            <span class="lang-item-flag">üá´üá∑</span>
                            <span class="lang-item-code">Fran√ßais</span>
                        </div>
                        <div class="lang-item" data-value="es" data-flag="üá™üá∏" data-code="ES" onclick="selectLang(this)">
                            <span class="lang-item-flag">üá™üá∏</span>
                            <span class="lang-item-code">Espa√±ol</span>
                        </div>
                    </div>
                </div>
                
                <!-- Currency Mini Dropdown -->
                <div class="currency-mini" id="currencyDropdown">
                    <input type="hidden" id="currency" name="currency" value="EUR">
                    <button type="button" class="currency-trigger" onclick="toggleCurrencyDropdown(event)">
                        <span class="currency-selected">‚Ç¨ EUR</span>
                        <i data-lucide="chevron-down" class="currency-arrow"></i>
                    </button>
                    <div class="currency-menu">
                        <div class="currency-item active" data-value="EUR" data-symbol="‚Ç¨" data-code="EUR" onclick="selectCurrency(this)">
                            <span class="item-symbol">‚Ç¨</span>
                            <span class="item-code">EUR</span>
                        </div>
                        <div class="currency-item" data-value="USD" data-symbol="$" data-code="USD" onclick="selectCurrency(this)">
                            <span class="item-symbol">$</span>
                            <span class="item-code">USD</span>
                        </div>
                        <div class="currency-item" data-value="GBP" data-symbol="¬£" data-code="GBP" onclick="selectCurrency(this)">
                            <span class="item-symbol">¬£</span>
                            <span class="item-code">GBP</span>
                        </div>
                        <div class="currency-item" data-value="TRY" data-symbol="‚Ç∫" data-code="TRY" onclick="selectCurrency(this)">
                            <span class="item-symbol">‚Ç∫</span>
                            <span class="item-code">TRY</span>
                        </div>
                        <div class="currency-item" data-value="CHF" data-symbol="Fr" data-code="CHF" onclick="selectCurrency(this)">
                            <span class="item-symbol">Fr</span>
                            <span class="item-code">CHF</span>
                        </div>
                    </div>
                </div>
                
                <!-- Profile Button -->
                <button type="button" class="profile-btn">
                    <i data-lucide="user" class="profile-icon"></i>
                </button>
            </div>
        </nav>

        <!-- Search Tab -->
        <div id="searchTab" class="tab-content active">
            <main>
                <form id="searchForm" class="search-form">
                <div class="form-section">
                    <h2><i data-lucide="plane-takeoff" class="section-icon"></i> Departure Airports</h2>
                    <div class="airport-inputs">
                        <div class="input-group">
                            <label for="origin1"><i data-lucide="user" class="label-icon"></i> Person 1 - From</label>
                            <div class="airport-search-container">
                                <i data-lucide="map-pin" class="input-icon"></i>
                                <input type="text" id="origin1" name="origin1" class="airport-search has-icon" placeholder="Search airport..." autocomplete="off" required>
                                <input type="hidden" id="origin1Code" name="origin1Code">
                                <div id="origin1Dropdown" class="airport-dropdown"></div>
                            </div>
                        </div>
                        <div class="input-group">
                            <label for="origin2"><i data-lucide="user" class="label-icon"></i> Person 2 - From</label>
                            <div class="airport-search-container">
                                <i data-lucide="map-pin" class="input-icon"></i>
                                <input type="text" id="origin2" name="origin2" class="airport-search has-icon" placeholder="Search airport..." autocomplete="off" required>
                                <input type="hidden" id="origin2Code" name="origin2Code">
                                <div id="origin2Dropdown" class="airport-dropdown"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2><i data-lucide="plane-landing" class="section-icon"></i> Destination</h2>
                    <div class="destination-type-toggle">
                        <button type="button" class="toggle-btn active" data-type="airport" onclick="setDestinationType('airport')">
                            <i data-lucide="building-2" class="toggle-icon"></i>
                            Airport
                        </button>
                        <button type="button" class="toggle-btn" data-type="country" onclick="setDestinationType('country')">
                            <i data-lucide="flag" class="toggle-icon"></i>
                            Country
                        </button>
                        <button type="button" class="toggle-btn" data-type="everywhere" onclick="setDestinationType('everywhere')">
                            <i data-lucide="globe" class="toggle-icon"></i>
                            Everywhere
                        </button>
                    </div>
                    <div class="input-group" id="airportDestGroup">
                        <label for="destination"><i data-lucide="map-pin" class="label-icon"></i> Flying To (Airport)</label>
                        <div class="airport-search-container">
                            <i data-lucide="search" class="input-icon"></i>
                            <input type="text" id="destination" name="destination" class="airport-search has-icon" placeholder="Search airport..." autocomplete="off">
                            <input type="hidden" id="destinationCode" name="destinationCode">
                            <div id="destinationDropdown" class="airport-dropdown"></div>
                        </div>
                    </div>
                    <div class="input-group" id="countryDestGroup" style="display: none;">
                        <label for="countryDestination"><i data-lucide="flag" class="label-icon"></i> Flying To (Country)</label>
                        <div class="airport-search-container">
                            <i data-lucide="search" class="input-icon"></i>
                            <input type="text" id="countryDestination" name="countryDestination" class="airport-search has-icon" placeholder="Search country..." autocomplete="off">
                            <input type="hidden" id="countryCode" name="countryCode">
                            <div id="countryDropdown" class="airport-dropdown"></div>
                        </div>
                        <p class="input-hint"><i data-lucide="lightbulb" class="hint-icon"></i> We'll find the best airports in this country for both of you!</p>
                    </div>
                    <div class="input-group" id="everywhereDestGroup" style="display: none;">
                        <div class="everywhere-info">
                            <div class="everywhere-icon-wrapper">
                                <i data-lucide="globe-2" class="everywhere-icon-svg"></i>
                            </div>
                            <div class="everywhere-text">
                                <strong>Search Everywhere!</strong>
                                <p>We'll find the top 10 cheapest destinations worldwide for both of you to meet.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2><i data-lucide="calendar" class="section-icon"></i> Travel Dates</h2>
                    <div class="date-inputs">
                        <div class="input-group">
                            <label><i data-lucide="calendar-plus" class="label-icon"></i> From Date</label>
                            <div class="custom-date-picker" id="dateFromPicker">
                                <input type="hidden" id="dateFrom" name="dateFrom" required>
                                <button type="button" class="date-trigger" onclick="toggleDatePicker('dateFrom')">
                                    <i data-lucide="calendar" class="date-icon"></i>
                                    <span class="date-display" id="dateFromDisplay">Select date</span>
                                    <i data-lucide="chevron-down" class="date-arrow"></i>
                                </button>
                                <div class="date-dropdown">
                                    <div class="date-header">
                                        <button type="button" class="date-nav" onclick="changeMonth('dateFrom', -1)">
                                            <i data-lucide="chevron-left"></i>
                                        </button>
                                        <span class="date-month" id="dateFromMonth">December 2025</span>
                                        <button type="button" class="date-nav" onclick="changeMonth('dateFrom', 1)">
                                            <i data-lucide="chevron-right"></i>
                                        </button>
                                    </div>
                                    <div class="date-weekdays">
                                        <span>Su</span><span>Mo</span><span>Tu</span><span>We</span><span>Th</span><span>Fr</span><span>Sa</span>
                                    </div>
                                    <div class="date-days" id="dateFromDays"></div>
                                </div>
                            </div>
                        </div>
                        <div class="input-group">
                            <label><i data-lucide="calendar-check" class="label-icon"></i> To Date</label>
                            <div class="custom-date-picker" id="dateToPicker">
                                <input type="hidden" id="dateTo" name="dateTo" required>
                                <button type="button" class="date-trigger" onclick="toggleDatePicker('dateTo')">
                                    <i data-lucide="calendar" class="date-icon"></i>
                                    <span class="date-display" id="dateToDisplay">Select date</span>
                                    <i data-lucide="chevron-down" class="date-arrow"></i>
                                </button>
                                <div class="date-dropdown">
                                    <div class="date-header">
                                        <button type="button" class="date-nav" onclick="changeMonth('dateTo', -1)">
                                            <i data-lucide="chevron-left"></i>
                                        </button>
                                        <span class="date-month" id="dateToMonth">January 2026</span>
                                        <button type="button" class="date-nav" onclick="changeMonth('dateTo', 1)">
                                            <i data-lucide="chevron-right"></i>
                                        </button>
                                    </div>
                                    <div class="date-weekdays">
                                        <span>Su</span><span>Mo</span><span>Tu</span><span>We</span><span>Th</span><span>Fr</span><span>Sa</span>
                                    </div>
                                    <div class="date-days" id="dateToDays"></div>
                                </div>
                            </div>
                        </div>
                        <div class="input-group">
                            <label><i data-lucide="clock" class="label-icon"></i> Trip Duration</label>
                            <div class="duration-selector">
                                <button type="button" class="duration-btn" onclick="changeDuration(-1)">
                                    <i data-lucide="minus"></i>
                                </button>
                                <div class="duration-display">
                                    <input type="number" class="duration-input" id="tripDays" name="tripDays" value="3" min="1" max="30" required onchange="updateDurationDisplay()">
                                    <span class="duration-label">days</span>
                                </div>
                                <button type="button" class="duration-btn" onclick="changeDuration(1)">
                                    <i data-lucide="plus"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h2><i data-lucide="settings" class="section-icon"></i> Options</h2>
                    <div class="switch-group">
                        <label class="switch-label">
                            <div class="switch-info">
                                <i data-lucide="arrow-right" class="switch-icon"></i>
                                <span class="switch-text">Direct flights only</span>
                            </div>
                            <div class="switch-toggle">
                                <input type="checkbox" id="directOnly" name="directOnly">
                                <span class="switch-slider"></span>
                            </div>
                        </label>
                    </div>
                </div>

                <button type="submit" class="search-btn" id="searchBtn">
                    <span class="btn-text">
                        <i data-lucide="search" class="btn-icon"></i>
                        Search Flights
                    </span>
                    <span class="btn-loading" style="display: none;">
                        <span class="spinner"></span>
                        Searching...
                    </span>
                </button>
            </form>

            <!-- Progress Indicator -->
            <div id="progressIndicator" class="progress-indicator" style="display: none;">
                <div class="progress-steps">
                    <div class="progress-step" data-step="1">
                        <div class="step-icon">‚úàÔ∏è</div>
                        <div class="step-text">Searching flights for Person 1...</div>
                    </div>
                    <div class="progress-step" data-step="2">
                        <div class="step-icon">‚úàÔ∏è</div>
                        <div class="step-text">Searching flights for Person 2...</div>
                    </div>
                    <div class="progress-step" data-step="3">
                        <div class="step-icon">üîÑ</div>
                        <div class="step-text">Finding best matching dates...</div>
                    </div>
                    <div class="progress-step" data-step="4">
                        <div class="step-icon">üí∞</div>
                        <div class="step-text">Calculating combined prices...</div>
                    </div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
            </div>

            <div id="results" class="results-container" style="display: none;">
                <h2>Search Results</h2>
                
                <div id="destinationResults" class="destination-results" style="display: none;">
                    <h3>Best Destinations Found</h3>
                    <div class="destinations-list"></div>
                </div>
                
                <div id="bestMatch" class="best-match" style="display: none;">
                    <h3>Best Combined Option</h3>
                    <div class="match-content"></div>
                </div>

                <div id="pairedFlights" class="paired-flights-container">
                    <!-- Flights paired by date will be shown here -->
                </div>

                <div class="results-grid" style="display: none;">
                    <div id="results1" class="flight-results">
                        <h3>Person 1 Flights</h3>
                        <div class="flights-list"></div>
                    </div>
                    <div id="results2" class="flight-results">
                        <h3>Person 2 Flights</h3>
                        <div class="flights-list"></div>
                    </div>
                </div>
            </div>

            <div id="error" class="error-message" style="display: none;"></div>
            </main>
        </div>

        <!-- Info Tab -->
        <div id="infoTab" class="tab-content">
            <div class="info-page">
                <h2>How to Use MeetOnSamePage</h2>
                
                <div class="info-section">
                    <h3>1. Enter Departure Airports</h3>
                    <p>Enter the airports where each person will be departing from. Start typing the city or airport code and select from the dropdown.</p>
                </div>

                <div class="info-section">
                    <h3>2. Choose Your Destination</h3>
                    <p>You have three options:</p>
                    <ul>
                        <li><strong>Airport:</strong> Search for flights to a specific airport</li>
                        <li><strong>Country:</strong> Find the best airports in a country for both of you</li>
                        <li><strong>Everywhere:</strong> Discover the cheapest destinations worldwide</li>
                    </ul>
                </div>

                <div class="info-section">
                    <h3>3. Set Travel Dates</h3>
                    <p>Choose your date range and trip duration. We'll find flights where both travelers can meet on the same dates.</p>
                </div>

                <div class="info-section">
                    <h3>4. View Results</h3>
                    <p>Results show flight combinations sorted by total price. Each result displays:</p>
                    <ul>
                        <li>Combined total price for both travelers</li>
                        <li>Individual flight details side by side</li>
                        <li>Direct booking links to Kiwi.com</li>
                    </ul>
                </div>

                <div class="info-section">
                    <h3>Tips</h3>
                    <ul>
                        <li>Use "Direct flights only" for faster, simpler travel</li>
                        <li>Try "Everywhere" search to discover unexpected cheap destinations</li>
                        <li>Flexible dates give you more options</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Flight Details Modal -->
        <div id="flightModal" class="modal" style="display: none;">
            <div class="modal-content">
                <button class="modal-close" onclick="closeModal()">&times;</button>
                <h2>Flight Details</h2>
                <div id="modalBody" class="modal-body"></div>
            </div>
        </div>
    </div>

    <script src="/static/script.js"></script>
    <script>
        // Initialize Lucide icons
        lucide.createIcons();
    </script>
</body>
</html>
